<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç®¡ç†åå° - ç¡çœ åŠ©æ‰‹</title>
    <link rel="stylesheet" href="css/style.css">
    <style>
        .admin-container {
            max-width: 800px;
            margin: 60px auto;
            padding: 20px;
        }
        .admin-box {
            background: white;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .admin-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        .admin-card {
            background: #F9F8F6;
            padding: 30px;
            border-radius: 12px;
            border: 2px solid #E0DED9;
            transition: all 0.3s;
            cursor: pointer;
            text-decoration: none;
            color: inherit;
            display: block;
        }
        .admin-card:hover {
            border-color: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .admin-card h2 {
            color: var(--primary-color);
            margin-bottom: 15px;
            font-size: 24px;
        }
        .admin-card p {
            color: var(--secondary-text);
            line-height: 1.6;
            margin-bottom: 10px;
        }
        .admin-card .features {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #E0DED9;
        }
        .admin-card .features li {
            color: var(--text-color);
            font-size: 14px;
            margin-bottom: 8px;
            list-style: none;
            padding-left: 20px;
            position: relative;
        }
        .admin-card .features li:before {
            content: "â€¢";
            position: absolute;
            left: 0;
            color: var(--primary-color);
            font-weight: bold;
        }
        .login-box {
            background: white;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            max-width: 400px;
            margin: 60px auto;
        }
        .form-group {
            margin-bottom: 20px;
        }
        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-color);
            font-size: 14px;
        }
        .form-group input {
            width: 100%;
            padding: 12px;
            border: 1px solid #E0DED9;
            border-radius: 6px;
            font-size: 14px;
            box-sizing: border-box;
        }
        .submit-btn {
            width: 100%;
            padding: 14px;
            background: var(--primary-color);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            margin-top: 10px;
        }
        .submit-btn:hover {
            opacity: 0.9;
        }
        .error-message {
            background: #FFF0F0;
            color: #D32F2F;
            padding: 12px;
            border-radius: 6px;
            margin-bottom: 20px;
            font-size: 14px;
            display: none;
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <div class="container">
            <div class="logo">ç¡çœ åŠ©æ‰‹ - ç®¡ç†åå°</div>
            <ul class="nav-links">
                <li><a href="index.html">è¿”å›é¦–é¡µ</a></li>
            </ul>
        </div>
    </nav>

    <main>
        <!-- ç™»å½•æ¡† -->
        <div id="loginBox" class="login-box">
            <h2 style="text-align: center; margin-bottom: 30px;">ç®¡ç†å‘˜ç™»å½•</h2>
            <div id="errorMessage" class="error-message"></div>
            <form id="loginForm">
                <div class="form-group">
                    <label>ç®¡ç†å‘˜å¯†é’¥</label>
                    <input type="password" id="adminKey" placeholder="è¯·è¾“å…¥ç®¡ç†å‘˜å¯†é’¥" required>
                </div>
                <button type="submit" class="submit-btn">ç™»å½•</button>
            </form>
        </div>

        <!-- ç®¡ç†åŠŸèƒ½åˆ—è¡¨ -->
        <div id="adminContainer" class="admin-container" style="display: none;">
            <div class="admin-box">
                <h1 style="text-align: center; margin-bottom: 10px;">ç®¡ç†åå°</h1>
                <p style="text-align: center; color: var(--secondary-text); margin-bottom: 30px;">
                    é€‰æ‹©ä½ è¦ç®¡ç†çš„åŠŸèƒ½
                </p>

                <div class="admin-grid">
                    <!-- æ•°æ®ç»Ÿè®¡ -->
                    <a href="admin-statistics.html" class="admin-card">
                        <h2>ğŸ“Š æ•°æ®ç»Ÿè®¡</h2>
                        <p>å®æ—¶æŸ¥çœ‹ç½‘ç«™è¿è¥æ•°æ®å’Œç”¨æˆ·è¡Œä¸ºåˆ†æ</p>
                        <ul class="features">
                            <li>ä»Šæ—¥UVã€PVæ•°æ®</li>
                            <li>æ–°å¢è®¿å®¢å’Œæ³¨å†Œç”¨æˆ·</li>
                            <li>æ³¨å†Œè½¬åŒ–ç‡ã€ç•™å­˜ç‡</li>
                            <li>ä»˜è´¹ç”¨æˆ·ç»Ÿè®¡</li>
                            <li>7æ—¥è¶‹åŠ¿åˆ†æ</li>
                        </ul>
                    </a>

                    <!-- ç”¨æˆ·ç®¡ç† -->
                    <a href="admin-users.html" class="admin-card">
                        <h2>ğŸ‘¥ ç”¨æˆ·ç®¡ç†</h2>
                        <p>æŸ¥çœ‹å’Œç®¡ç†æ‰€æœ‰æ³¨å†Œç”¨æˆ·ä¿¡æ¯</p>
                        <ul class="features">
                            <li>ç”¨æˆ·é‚®ç®±åˆ—è¡¨</li>
                            <li>æ³¨å†Œå’Œç™»å½•æ—¶é—´</li>
                            <li>ä»˜è´¹çŠ¶æ€æŸ¥çœ‹</li>
                            <li>ä½¿ç”¨å¯†ç è®°å½•</li>
                            <li>ç”¨æˆ·æœç´¢åŠŸèƒ½</li>
                        </ul>
                    </a>

                    <!-- å¯†ç ç®¡ç† -->
                    <a href="admin-password.html" class="admin-card">
                        <h2>ğŸ”‘ å¯†ç ç®¡ç†</h2>
                        <p>ç®¡ç†è§£é”å®Œæ•´æŠ¥å‘Šçš„ä¸€æ¬¡æ€§å¯†ç </p>
                        <ul class="features">
                            <li>ç”Ÿæˆæ–°çš„è§£é”å¯†ç </li>
                            <li>æŸ¥çœ‹å¯†ç ä½¿ç”¨çŠ¶æ€</li>
                            <li>è¿½è¸ªå¯†ç ä½¿ç”¨è®°å½•</li>
                            <li>æ‰¹é‡ç”Ÿæˆå¯†ç </li>
                            <li>è‡ªå®šä¹‰å¯†ç å‰ç¼€</li>
                        </ul>
                    </a>
                </div>

                <div style="text-align: center; margin-top: 30px;">
                    <button onclick="logout()" style="padding: 10px 30px; background: #ccc; color: white; border: none; border-radius: 6px; cursor: pointer;">
                        é€€å‡ºç™»å½•
                    </button>
                </div>
            </div>
        </div>
    </main>

    <footer>
        <div class="container">
            <p>&copy; 2024 ç¡çœ åŠ©æ‰‹. ç”¨å¿ƒç†è§£ï¼Œç§‘å­¦åŠ©çœ ã€‚</p>
        </div>
    </footer>

    <script>
        let adminKey = '';

        // æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
        function showError(message) {
            const errorDiv = document.getElementById('errorMessage');
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
        }

        // ç™»å½•è¡¨å•æäº¤
        document.getElementById('loginForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const key = document.getElementById('adminKey').value.trim();

            if (!key) {
                showError('è¯·è¾“å…¥ç®¡ç†å‘˜å¯†é’¥');
                return;
            }

            // éªŒè¯å¯†é’¥ï¼ˆé€šè¿‡è°ƒç”¨ç»Ÿè®¡APIï¼‰
            try {
                const response = await fetch('/api/admin?action=statistics', {
                    headers: { 'X-Admin-Key': key }
                });

                if (response.ok) {
                    // éªŒè¯æˆåŠŸ
                    adminKey = key;
                    localStorage.setItem('adminKey', key);
                    document.getElementById('loginBox').style.display = 'none';
                    document.getElementById('adminContainer').style.display = 'block';
                } else {
                    showError('ç®¡ç†å‘˜å¯†é’¥é”™è¯¯');
                }
            } catch (error) {
                showError('ç½‘ç»œé”™è¯¯ï¼Œè¯·æ£€æŸ¥è¿æ¥');
            }
        });

        // é€€å‡ºç™»å½•
        function logout() {
            if (confirm('ç¡®å®šè¦é€€å‡ºå—ï¼Ÿ')) {
                adminKey = '';
                localStorage.removeItem('adminKey');
                document.getElementById('loginBox').style.display = 'block';
                document.getElementById('adminContainer').style.display = 'none';
                document.getElementById('adminKey').value = '';
                document.getElementById('errorMessage').style.display = 'none';
            }
        }

        // é¡µé¢åŠ è½½æ—¶æ£€æŸ¥æ˜¯å¦å·²ç™»å½•
        window.addEventListener('DOMContentLoaded', async () => {
            const savedKey = localStorage.getItem('adminKey');
            if (savedKey) {
                // éªŒè¯ä¿å­˜çš„å¯†é’¥æ˜¯å¦ä»ç„¶æœ‰æ•ˆ
                try {
                    const response = await fetch('/api/admin?action=statistics', {
                        headers: { 'X-Admin-Key': savedKey }
                    });

                    if (response.ok) {
                        adminKey = savedKey;
                        document.getElementById('loginBox').style.display = 'none';
                        document.getElementById('adminContainer').style.display = 'block';
                    } else {
                        localStorage.removeItem('adminKey');
                    }
                } catch (error) {
                    console.error('éªŒè¯å¯†é’¥å¤±è´¥:', error);
                }
            }
        });
    </script>
</body>
</html>
